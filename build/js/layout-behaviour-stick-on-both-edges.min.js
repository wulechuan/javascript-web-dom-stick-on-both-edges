!function(n){function e(n,e){function o(){return e+Date.now()+"-"+(1e6*Math.random()+"").slice(0,6)}e="string"==typeof e?e:"",e=e.replace(/\-+$/,"")+"-";for(var t=o();n[t];)t=o();return t}(function(n,e,o,t){"use strict";function i(n,e){n.config(e),r(n),S.call(n,e,!0),"boolean"==typeof e.shouldEnableHanging?p.call(e.shouldEnableHanging,e.reasonForEnablingOrDisabling||e.reason||"User desired on initialization."):n.options.shouldEnableBahviourAtBeginning&&y.call(n,"Forced to enabled on initialization."),Y.call(n);var o=a(n).boundFunctions;window.addEventListener("scroll",o.listenToWindowOnScrollEvent)}function a(n){return an[n.__pToken]}function r(n){var e=a(n).boundFunctions;e.doIntervalOfRenewingState=b.bind(null,n),e.doIntervalOfUpdateLayout=B.bind(null,n),e.doUpdateLayout=function(){Q(n)}.bind(n);var o=t(n.options.throttleTimeInMSForScrollAndResizeListeners,e.doUpdateLayout);e.listenToWindowOnScrollEvent=o,e.listenToWindowOnResizeEvent=o}function s(){return a(this).isEnabled}function l(){var n=a(this);if(n.isInFreeLayout)return"free layout";if(n.isPinnedToWindowTop)return"pinned to top";if(n.isPinnerToParentBottom)return"following lower boundry";throw RangeError(nn,"Fatal: None of the three states are active.")}function u(n){var e=a(this);if(!n||"string"!=typeof n)return!1;switch(n.toLowerCase().replace(/\s*[\s\-]\s*/g,"-").replace(/^\s+/,"").replace(/\s+$/,"")){case"free":case"freelayout":case"default":return e.isInFreeLayout;case"top":case"hanging":case"pinned-to-top":return e.isPinnedToWindowTop;case"following":case"bottom":case"following-lower-boundry":case"pinned-to-bottom":return e.isPinnerToParentBottom}return!1}function d(n){var e,o,t,i=this,a=i.options,r=i.elements;e="hangingLowerBoundryRef",o=e+"El",n.hasOwnProperty(o)&&(t=n[o],r[e]instanceof Node?t instanceof Node&&(r[e]=t):t instanceof Node?r[e]=t:r[e]=r.parentPositionRef),e="intervalTimeInMSForRenewingState",n.hasOwnProperty(e)&&(t=parseInt(n[e]),!isNaN(t)&&t>20&&(a[e]=t)),e="intervalTimeInMSForUpdatingLayout",n.hasOwnProperty(e)&&(t=parseInt(n[e]),!isNaN(t)&&t>20&&(a[e]=t)),c(i,"onEnabling",n),c(i,"onEnabled",n),c(i,"onDisabling",n),c(i,"onDisabled",n),c(i,"onDestroying",n),c(i,"onDestroyed",n),c(i,"onReturningToFreeLayout",n),c(i,"onReturnedToFreeLayout",n),c(i,"onIntervalBegin",n),c(i,"onIntervalEnd",n)}function c(n,e,o){var t=a(n).events,i=o[e];"function"!=typeof i&&void 0!==i||(t[e]=i)}function g(n,e,o,t){var i=a(n).events;return"function"!=typeof i[e]?void(o&&(t=t||'The "'+e+'" is NOT handled.',tn.warn(t))):i[e].call(n,n.state)}function f(n){T.call(this,n,!0)}function h(n){var e=n.elements,o=a(n).boundFunctions;window.removeEventListener("scroll",o.listenToWindowOnScrollEvent),window.removeEventListener("resize",o.listenToWindowOnResizeEvent),e.root.style.height="",e.chiefContent.style.top="",Z(n,null),g(n,"onDestroyed",!0)}function p(n,e,o){if(void 0!==n){n=!!n;if(w(this,n,o)){var t=n?"Enabling":o?"DESTORYING":"DISABLING";return void tn.warn(t,"request was cancelled.")}var i={};i.shouldEnableHanging=!!n,i.reason=e&&"string"==typeof e?e:"<unkown>",!n&&o&&(i.isForcedToRenew=!0,i.shouldDestroyAfterDisabled=!0),M.call(this,i),Y.call(this)}}function y(n){p.call(this,!0,n)}function T(n,e){p.call(this,!1,n,e)}function w(n,e,o){if(e)return g(n,"onEnabling");var t=g(n,"onDisabling");if(t){if(!o)return t;tn.warn("Destroying request will be cancelled by onDisabling handler.")}return g(n,"onDestroying")}function v(n,e){var o=n.state;a(n).isEnabled=e,e?(delete o.shouldDestroyAfterDisabled,g(n,"onEnabled")):(g(n,"onDisabled"),n.clearIntervalOfRenewingState(),n.clearIntervalOfUpdateLayout(),o.shouldDestroyAfterDisabled&&h(n))}function L(){F(this,!0)}function m(){F(this,!1)}function F(n,e){var o=a(n),t=e?"Starting":"STOPPING",i="interval for renewing related info.",r="intervalIDForRenewingState",s=o[r],l=!isNaN(s);e&&!l?(tn.info(t,i),o[r]=setInterval(o.boundFunctions.doIntervalOfRenewingState,n.options.intervalTimeInMSForRenewingState)):!e&&l&&(tn.warn(t,i),clearInterval(s),o[r]=NaN)}function b(n){g(n,"onIntervalBegin")||(P.call(n,!0),k.call(n,!0),C.call(n,!0),H.call(n,!0)),g(n,"onIntervalEnd")}function I(){E(this,!0)}function N(){E(this,!1)}function E(n,e){var o=a(n),t=e?"Starting":"STOPPING",i="intervalIDForUpdatingLayout",r=o[i],s=!isNaN(r);e&&!s?(tn.info(t,"interval for updating layout."),o[i]=setInterval(o.boundFunctions.doIntervalOfUpdateLayout,n.options.intervalTimeInMSForUpdatingLayout)):!e&&s&&(tn.warn(t,"interval for updating layout."),clearInterval(r),o[i]=NaN)}function B(n){Y.call(n)}function R(n){S.call(this,n,!1),Y.call(this)}function S(n,e){var o=!0;"object"==typeof n&&n&&(O.call(this,n.contentTopToWindowTopInHangingLayouts,e),U.call(this,n.contentBottomToLowerBoundryInHangingLayouts,e),o=W.call(this,n.shouldUseBottomOfHangingLowerBoundryRef,e)),o&&k.call(this,e),P.call(this,e),C.call(this,e),H.call(this,e)}function P(n){var e={blockHeight:this.elements.chiefContent.offsetHeight};n&&(e.isForcedToUpdate=!0),M.call(this,e)}function C(n){var e={};n&&(e.isForcedToUpdate=!0),e.contentTopToRootTopInFreeLayout=this.elements.chiefContent.offsetTop,M.call(this,e)}function O(n,e){var o={};e&&(o.isForcedToUpdate=!0),n=parseFloat(n),isNaN(n)||(o.contentTopToWindowTopInHangingLayouts=n),M.call(this,o)}function U(n,e){var o={};e&&(o.isForcedToUpdate=!0),n=parseFloat(n),isNaN(n)||(o.contentBottomToLowerBoundryInHangingLayouts=n),M.call(this,o)}function H(n){var e,o=this,t=a(o),i=!0,r=!0;t.isInFreeLayout||(n?(t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1,e=o.state.methodForSwitchingToCurrentLayout,r=$(o,n,!0)):(i=!1,t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!0)),i&&D(o,n),r||"function"!=typeof e||e(o)}function D(n,e){var o=n.elements.chiefContent.getBoundingClientRect();if(0===o.width&&0===o.height)return void tn.warn('\n\t Cannot evaluate chiefContentEl\'s "boundingClientRect"!',"\n\t The chief content elment might not be visible at the moment.");var t={};e&&(t.isForcedToUpdate=!0),t.contentTopToPageTopInFreeLayout=o.top+window.scrollY,M.call(n,t)}function W(n,e){var o=this,t=o.elements;if(t.parentPositionRef===t.hangingLowerBoundryRef||null===n||void 0===n)return!0;o.state.shouldUseBottomOfHangingLowerBoundryRef=!!n;var i={};return e&&(i.isForcedToUpdate=!0),k.call(this,e),!1}function k(n){var e=A(this);n&&(e.isForcedToUpdate=!0),M.call(this,e)}function A(n){var e=n.state,o="hangingLowerBoundryToPageTop",t=NaN,i=NaN,r=n.elements.hangingLowerBoundryRef.getBoundingClientRect();0===r.width&&0===r.height?tn.warn("Reference element for deciding hanging lower boundry is invisible at this moment."):(t=r[e.shouldUseBottomOfHangingLowerBoundryRef?"bottom":"top"],i=t+window.scrollY),a(n).hangingLowerBoundryToWindowTop=t,e[o]=i;var s={};return s[o]=i,s}function M(n){var e=this,t=a(e).queuedStatesForUpdating;!t[t.length-1]&&t.push({});var i=t[t.length-1];"function"==typeof n?n.call(e,i):"object"!=typeof n||Array.isArray(n)?i.isForcedToUpdate=i.isForcedToUpdate||void 0===n||!!n:o(i,n)}function x(n){var e=a(n),o=e.queuedStatesForUpdating.shift();return q(n,n.state,o),o}function j(n,e){o(n.state,e)}function q(n,e,o){z(n,e,o),_(n,o)}function z(n,e,o){Object.keys(n.state).forEach(function(t){G(t,e,o)?a(n).somethingChanged=!0:delete o[t]})}function G(n,e,o){var t=!1,i=e[n],a=o[n];return void 0!==a&&null!==a&&(void 0===i||null===i?t=!0:i!==a&&(t=!(isNaN(i)&&isNaN(a))),t)}function _(n,e){if(a(n).somethingChanged){var o,t,i,r;if("boolean"==typeof e.shouldEnableHanging){o="reason";var s=e.shouldEnableHanging;t=s?"Enabling":e.shouldDestroyAfterDisabled?"DESTORYING":"DISABLING",i="behaviour...\n",r=e[o],r=en.slice("Reason: ".length)+"Reason: "+r.replace(/\n/g,"\n "+en),s?tn.info(t,i,r):tn.warn(t,i," ",r)}}}function Y(){var n=this,e=a(n),o=n.state;if(!(e.queuedStatesForUpdating.length<1)){var t=x(n),i=t.isForcedToUpdate;delete t.isForcedToUpdate,(e.somethingChanged||i)&&(j(n,t),Q(n,i)),"boolean"==typeof t.shouldEnableHanging&&(v(n,t.shouldEnableHanging),delete o.reason)}}function Q(n,e){var o=n.elements,t=a(n),i=n.state;A(n);var r=i.contentTopToWindowTopInHangingLayouts,s=window.scrollY+r,l=i.hangingLowerBoundryToPageTop-i.contentTopToPageTopInFreeLayout,u=i.blockHeight+i.contentBottomToLowerBoundryInHangingLayouts,d=t.hangingLowerBoundryToWindowTop-r,c=i.blockHeight,g=window.innerHeight<u||!isNaN(l)&&l<u;!i.shouldEnableHanging||g||s<=i.contentTopToPageTopInFreeLayout?$(n,e):d<=u?J(n,e,c,l-u+o.root.clientTop+i.contentTopToRootTopInFreeLayout):V(n,e,c,i.contentTopToWindowTopInHangingLayouts),t.somethingChanged=!1,delete i.methodForSwitchingToCurrentLayout}function $(n,e,o){var t=a(n),i=t.isInFreeLayout,r=K(n,{methodForSwitchingToCurrentLayout:$,isForcedToUpdate:e,pNameOfLayoutMark:"isInFreeLayout",pNameOfCssClass:o?"layoutFreeTemporary":"layoutFree",rootElHeight:"",contentElTop:""});if(!r){var s=n.options.shouldAlwaysRenewFreeLayoutInfo;!s&&!t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout||i||R.call(n),t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1}return r}function V(n,e,o,t){return K(n,{methodForSwitchingToCurrentLayout:V,isForcedToUpdate:e,pNameOfLayoutMark:"isPinnedToWindowTop",pNameOfCssClass:"layoutPinToWindowTop",rootElHeight:o+"px",contentElTop:t+"px"})}function J(n,e,o,t){return K(n,{methodForSwitchingToCurrentLayout:J,isForcedToUpdate:e,pNameOfLayoutMark:"isPinnerToParentBottom",pNameOfCssClass:"layoutPinToParentBottom",rootElHeight:o+"px",contentElTop:t+"px"})}function K(n,e){var o=a(n),t=n.state,i=n.elements,r=e.pNameOfLayoutMark,s=e.logStringWhenActuallySwitching;return!(!o[r]||o.somethingChanged||e.isForcedToUpdate)||(e.shouldDebug&&s&&tn.info(s),t.methodForSwitchingToCurrentLayout=e.methodForSwitchingToCurrentLayout,X(n,r),Z(n,e.pNameOfCssClass),i.chiefContent.style.top=e.contentElTop,i.root.style.height=e.rootElHeight,!1)}function X(n,e){var o=a(n);["isInFreeLayout","isPinnedToWindowTop","isPinnerToParentBottom"].forEach(function(n){o[n]=e===n})}function Z(n,e){var o=n.elements.chiefContent.classList,t=n.options.cssClassName;for(var i in t){var a=t[i];i===e?a&&o.add(a):a&&o.remove(a)}}var nn="{"+n+"} ==>",en=nn.replace(/\S/g," "),on=window.console,tn={};["log","info","warn","debug","trace","error"].forEach(function(n){var e=on[n];"function"==typeof e&&(tn[n]=e.bind(on,nn))});var an={};return function(o){var t=this;if(t.console=tn,t.options={shouldEnableBahviourAtBeginning:!1,shouldAlwaysRenewFreeLayoutInfo:!0,cssClassName:{layoutFreeTemporary:"js-stick-on-both-edges-layout-temporarily-free",layoutFree:"js-stick-on-both-edges-layout-free",layoutPinToWindowTop:"js-stick-on-both-edges-layout-hang-to-window-top",layoutPinToParentBottom:"js-stick-on-both-edges-layout-pin-to-lower-boundry"},intervalTimeInMSForRenewingState:500,intervalTimeInMSForUpdatingLayout:40,throttleTimeInMSForScrollAndResizeListeners:16},t.state={shouldEnableHanging:!1,blockHeight:NaN,contentTopToPageTopInFreeLayout:NaN,contentTopToRootTopInFreeLayout:0,contentTopToWindowTopInHangingLayouts:0,contentBottomToLowerBoundryInHangingLayouts:15,shouldUseBottomOfHangingLowerBoundryRef:!1,hangingLowerBoundryToPageTop:NaN},o=o||{},!(o.parentPositionRefEl instanceof Node))throw new Error("Invalid parentPositionRef element.");if(!(o.rootEl instanceof Node))throw new Error("Invalid root element.");if(!(o.chiefContentEl instanceof Node))throw new Error("Invalid chiefContent element.");t.elements={root:o.rootEl,chiefContent:o.chiefContentEl,parentPositionRef:o.parentPositionRefEl,hangingLowerBoundryRef:null};var a={isEnabled:!1,isInFreeLayout:!0,isPinnedToWindowTop:!1,isPinnerToParentBottom:!1,events:{},boundFunctions:{},queuedStatesForUpdating:[],somethingChanged:!1,hangingLowerBoundryToWindowTop:NaN,shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout:!1,intervalIDForRenewingState:NaN,intervalIDForUpdatingLayout:NaN};t.__pToken=e(an,n),an[t.__pToken]=a,t.config=d,t.isEnabled=s,t.currentLayout=l,t.currentLayoutIs=u,t.enableOrDisableHangingBehaviour=p,t.enableHangingBehaviour=y,t.disableHangingBehaviour=T,t.destroy=f,t.renewStateAndThenUpdate=R,t.renewState=S,t.renewContentTopToWindowTopInHangingLayouts=O,t.renewHangingLowerBoundryValue=k,t.renewHangingLowerBoundryUsedBorder=W,t.startIntervalOfRenewingState=L,t.clearIntervalOfRenewingState=m,t.startIntervalOfUpdateLayout=I,t.clearIntervalOfUpdateLayout=N,t.requestLayoutUpdate=M,t.updateLayout=Y,i(t,o)}})("StickOnBothEdges",e,window.jQuery.extend,window.jQuery.throttle)}();