!function(e){function n(e,n){function t(){return n+Date.now()+"-"+(1e6*Math.random()+"").slice(0,6)}n="string"==typeof n?n:"",n=n.replace(/\-+$/,"")+"-";for(var o=t();e[o];)o=t();return o}function t(e,n){if(!e||"object"!=typeof e)return null;if(!n||"object"!=typeof n)return e;for(var t in n){var o=n[t];void 0!==o&&(Array.isArray(o)&&Array.isArray(e[t])?Array.prototype.push.apply(e[t],o):e[t]=o)}return e}function o(e,n){if(!(e instanceof Node&&n instanceof Node))return!1;for(var t=!1;e!==n&&e!==document.documentElement;)(e=e.parentNode)===n&&(t=!0);return t}var a=function(e,n,t,o,a){"use strict";function i(e,n){e.config(n),l(e),O.call(e,n,!0),"boolean"==typeof n.shouldEnableOnInit?w.call(e,n.shouldEnableOnInit,n.reasonForEnablingOrDisabling||n.reason||"User desired on initialization."):e.options.shouldEnableOnInit&&h.call(e,"Forced to enabled on initialization."),Y.call(e);var t=r(e).boundFunctions;window.addEventListener("scroll",t.listenToScrollEvent),window.addEventListener("resize",t.listenToResizeEvent)}function r(e){return ie[e.__pToken]}function l(e){var n=r(e).boundFunctions;n.doIntervalOfRenewingState=E.bind(null,e),n.doIntervalOfLayoutUpdate=R.bind(null,e),n.doUpdateLayout=function(){q(e)}.bind(e);var t=a(e.options.throttleTimeForScrollAndResizeListeners,n.doUpdateLayout);n.listenToScrollEvent=t,n.listenToResizeEvent=t}function s(){return r(this).state.isEnabled}function u(){var e=r(this).state.layouts;if(e.isFreeLayout)return"free layout";if(e.isPinnedToWindowTop)return"pinned to top";if(e.isPinnerToParentBottom)return"following lower boundary";throw RangeError(ne,"Fatal: None of the three states are active.")}function d(e){var n=r(this).state.layouts;if(!e||"string"!=typeof e)return!1;switch(e.toLowerCase().replace(/\s*[\s\-]\s*/g,"-").replace(/^\s+/,"").replace(/\s+$/,"")){case"free":case"freelayout":case"default":return n.isFreeLayout;case"top":case"hanging":case"pinned-to-top":return n.isPinnedToWindowTop;case"following":case"bottom":case"following-lower-boundary":case"pinned-to-bottom":return n.isPinnerToParentBottom}return!1}function c(e){var n,t,o=this,a=o.options;n="intervalTimeForRenewingState",e.hasOwnProperty(n)&&(t=parseInt(e[n]),!isNaN(t)&&t>20&&(a[n]=t)),n="intervalTimeForUpdatingLayout",e.hasOwnProperty(n)&&(t=parseInt(e[n]),!isNaN(t)&&t>20&&(a[n]=t)),f(o,"onEnabling",e),f(o,"onEnabled",e),f(o,"onDisabling",e),f(o,"onDisabled",e),f(o,"onDestroying",e),f(o,"onDestroyed",e),f(o,"onReturningToFreeLayout",e),f(o,"onReturnedToFreeLayout",e),f(o,"onIntervalBegin",e),f(o,"onIntervalEnd",e)}function f(e,n,t){var o=r(e).events,a=t[n];"function"!=typeof a&&void 0!==a||(o[n]=a)}function g(e,n,t){var o=r(e).events;return"function"!=typeof o[n]?void(t&&ae.warn('The "'+n+'" is NOT handled.')):o[n].call(e,e.state)}function h(e){w.call(this,!0,e)}function y(e,n){w.call(this,!1,e,n)}function p(e){y.call(this,e,!0)}function w(e,n,t){if(void 0!==e){e=!!e;if(T(this,e,t)){var o=e?"Enabling":t?"DESTORYING":"DISABLING";return void ae.warn(o,"request was cancelled.")}var a={};a.shouldEnable=!!e,a.reason=n&&"string"==typeof n?n:"<unkown>",!e&&t&&(a.isForcedToRenew=!0,a.shouldDestroyAfterDisabled=!0),j.call(this,a),Y.call(this)}}function T(e,n,t){if(n)return g(e,"onEnabling");var o=g(e,"onDisabling");if(o){if(!t)return o;ae.warn("Destroying request will be cancelled by onDisabling handler.")}return g(e,"onDestroying")}function v(e,n){var t=e.state;r(e).state.isEnabled=n,n?(delete t.shouldDestroyAfterDisabled,g(e,"onEnabled")):(g(e,"onDisabled"),e.clearIntervalOfRenewingState(),e.clearIntervalOfLayoutUpdate(),t.shouldDestroyAfterDisabled&&m(e))}function m(e){var n=e.elements,t=r(e).boundFunctions;window.removeEventListener("scroll",t.listenToScrollEvent),window.removeEventListener("resize",t.listenToResizeEvent),n.root.style.height="",n.hangingBlock.style.top="",ee(e,null),g(e,"onDestroyed",!0)}function L(){F(this,!0)}function b(){F(this,!1)}function F(e,n){var t=r(e),o=t.state,a=n?"Starting":"STOPPING",i="interval for renewing related info.",l="intervalIDForRenewingState",s=o[l],u=!isNaN(s);n&&!u?(ae.info(a,i),o[l]=setInterval(t.boundFunctions.doIntervalOfRenewingState,e.options.intervalTimeForRenewingState)):!n&&u&&(ae.warn(a,i),clearInterval(s),o[l]=NaN)}function E(e){g(e,"onIntervalBegin")||O.call(e,null,!0),g(e,"onIntervalEnd")}function N(){B(this,!0)}function I(){B(this,!1)}function B(e,n){var t=r(e),o=t.state,a=n?"Starting":"STOPPING",i="intervalIDForUpdatingLayout",l=o[i],s=!isNaN(l);n&&!s?(ae.info(a,"interval for updating layout."),o[i]=setInterval(t.boundFunctions.doIntervalOfLayoutUpdate,e.options.intervalTimeForUpdatingLayout)):!n&&s&&(ae.warn(a,"interval for updating layout."),clearInterval(l),o[i]=NaN)}function R(e){Y.call(e)}function S(e){O.call(this,e,!1),Y.call(this)}function O(e,n){if("object"==typeof e&&e){U.call(this,e.contentTopToWindowTopInHangingLayouts,n),k.call(this,e.contentBottomToLowerBoundaryInHangingLayouts,n);P.call(this,e.lowerBoundaryRefElement,n)||C.call(this,e.shouldUseBottomEdgeOfLowerBoundaryRefElement,n)}D.call(this,n),A.call(this,n),H.call(this,n)}function U(e,n){var t={};n&&(t.isForcedToUpdate=!0),e=parseFloat(e),isNaN(e)||(t.contentTopToWindowTopInHangingLayouts=e),j.call(this,t)}function k(e,n){var t={};n&&(t.isForcedToUpdate=!0),e=parseFloat(e),isNaN(e)||(t.contentBottomToLowerBoundaryInHangingLayouts=e),j.call(this,t)}function P(e,n){var t={};n&&(t.isForcedToUpdate=!0);var a=this.elements,i=a.root,r="lowerBoundaryRef",l=!0,s="This doesn't make any sense. Ref element NOT renewed.";null!==e&&(e instanceof Node?o(e,i)?(l=!1,ae.warn("The lower boundary ref element","is a descendant of the root element.",s)):e===i&&(l=!1,ae.warn("The lower boundary ref element","is the same dom as the root element.",s)):l=!1);var u=!1;return l&&a[r]!==e&&(a[r]=e,t[r+"Element"]=e,o(i,e)&&(C.call(this,!0,n),u=!0),j.call(this,t)),u}function C(e,n){var t=this,a=t.elements;if("boolean"==typeof e&&!o(a.root,a.lowerBoundaryRef)){var i={};n&&(i.isForcedToUpdate=!0),i.shouldUseBottomEdgeOfLowerBoundaryRefElement=!!e,j.call(t,i)}}function D(e){var n={blockHeight:this.elements.hangingBlock.offsetHeight};e&&(n.isForcedToUpdate=!0),j.call(this,n)}function A(e){var n={};e&&(n.isForcedToUpdate=!0),n.contentTopToRootTopInFreeLayout=this.elements.hangingBlock.offsetTop,j.call(this,n)}function H(e){var n,t=this,o=r(t).state,a=!0,i=!0;o.layouts.isFreeLayout||(e?(o.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1,n=t.state.methodForSwitchingToCurrentLayout,i=J(t,e,!0)):(a=!1,o.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!0)),a&&W(t,e),i||"function"!=typeof n||n(t)}function W(e,n){var t=e.elements.hangingBlock.getBoundingClientRect();if(0===t.width&&0===t.height)return void ae.warn('\n\t Cannot evaluate hangingBlockElement\'s "boundingClientRect"!',"\n\t The chief content elment might not be visible at the moment.");var o={};n&&(o.isForcedToUpdate=!0),o.contentTopToPageTopInFreeLayout=t.top+window.scrollY,j.call(e,o)}function j(e){var n=this,o=r(n).updatingStatesQueue;!o[o.length-1]&&o.push({});var a=o[o.length-1];"function"==typeof e?e.call(n,a):"object"!=typeof e||Array.isArray(e)?a.isForcedToUpdate=a.isForcedToUpdate||void 0===e||!!e:t(a,e)}function x(e){var n=r(e),t=n.updatingStatesQueue.shift();return G(e,e.state,t),t}function z(e,n){t(e.state,n)}function G(e,n,t){Q(e,n,t),M(e,t)}function Q(e,n,t){Object.keys(e.state).forEach(function(o){_(o,n,t)?r(e).state.somethingChanged=!0:delete t[o]})}function _(e,n,t){var o=!1,a=n[e],i=t[e];return void 0!==i&&null!==i&&(void 0===a||null===a?o=!0:a!==i&&(o=!(isNaN(a)&&isNaN(i))),o)}function M(e,n){if(r(e).state.somethingChanged){var t,o,a,i;if("boolean"==typeof n.shouldEnable){t="reason";var l=n.shouldEnable;o=l?"Enabling":n.shouldDestroyAfterDisabled?"DESTORYING":"DISABLING",a="behaviour...\n",i=n[t],i=te.slice("Reason: ".length)+"Reason: "+i.replace(/\n/g,"\n "+te),l?ae.info(o,a,i):ae.warn(o,a," ",i)}}}function Y(){var e=this,n=r(e),t=e.state;if(!(n.updatingStatesQueue.length<1)){var o=x(e),a=o.isForcedToUpdate;delete o.isForcedToUpdate,(n.state.somethingChanged||a)&&(z(e,o),q(e,a)),"boolean"==typeof o.shouldEnable&&(v(e,o.shouldEnable),delete t.reason)}}function q(e,n){var t=r(e).state,o=e.state,a=e.elements;$(e);var i=o.contentTopToWindowTopInHangingLayouts,l=window.scrollY+i,s=o.hangingLowerBoundaryToPageTop-o.contentTopToPageTopInFreeLayout,u=o.blockHeight+o.contentBottomToLowerBoundaryInHangingLayouts,d=t.hangingLowerBoundaryToWindowTop-i,c=o.blockHeight,f=window.innerHeight<u||!isNaN(s)&&s<u;!o.shouldEnable||f||l<=o.contentTopToPageTopInFreeLayout?J(e,n):d<=u?V(e,n,c,s-u+a.root.clientTop+o.contentTopToRootTopInFreeLayout):K(e,n,c,o.contentTopToWindowTopInHangingLayouts),t.somethingChanged=!1,delete o.methodForSwitchingToCurrentLayout}function $(e){var n,t=e.state,o=t.lowerBoundaryRefElement,a=NaN,i=NaN;o instanceof Node&&(n=o.getBoundingClientRect(),0===n.width&&0===n.height?ae.warn("Reference element for deciding hanging lower boundary is invisible at this moment."):(a=n[t.shouldUseBottomEdgeOfLowerBoundaryRefElement?"bottom":"top"],i=a+window.scrollY)),r(e).state.hangingLowerBoundaryToWindowTop=a,t.hangingLowerBoundaryToPageTop=i}function J(e,n,t){var o=r(e).state,a=o.layouts.isFreeLayout,i=X(e,{methodForSwitchingToCurrentLayout:J,isForcedToUpdate:n,pNameOfLayoutMark:"isFreeLayout",pNameOfCssClass:t?"layoutFreeTemporary":"layoutFree",rootElHeight:"",contentElTop:""});if(!i){var l=e.options.shouldAlwaysRenewFreeLayoutInfo;!l&&!o.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout||a||S.call(e),o.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1}return i}function K(e,n,t,o){return X(e,{methodForSwitchingToCurrentLayout:K,isForcedToUpdate:n,pNameOfLayoutMark:"isPinnedToWindowTop",pNameOfCssClass:"layoutPinToWindowTop",rootElHeight:t+"px",contentElTop:o+"px"})}function V(e,n,t,o){return X(e,{methodForSwitchingToCurrentLayout:V,isForcedToUpdate:n,pNameOfLayoutMark:"isPinnerToParentBottom",pNameOfCssClass:"layoutPinToParentBottom",rootElHeight:t+"px",contentElTop:o+"px"})}function X(e,n){var t=r(e).state,o=e.state,a=e.elements,i=n.pNameOfLayoutMark,l=n.logStringWhenActuallySwitching;return!(!t.layouts[i]||t.somethingChanged||n.isForcedToUpdate)||(n.shouldDebug&&l&&ae.info(l),o.methodForSwitchingToCurrentLayout=n.methodForSwitchingToCurrentLayout,Z(e,i),ee(e,n.pNameOfCssClass),a.hangingBlock.style.top=n.contentElTop,a.root.style.height=n.rootElHeight,!1)}function Z(e,n){var t=r(e).state.layouts;Object.keys(t).forEach(function(e){t[e]=n===e})}function ee(e,n){var t=e.elements.hangingBlock.classList,o=e.options.cssClassName;for(var a in o){var i=o[a];a===n?i&&t.add(i):i&&t.remove(i)}}var ne="{"+e+"} ==>",te=ne.replace(/\S/g," "),oe=window.console,ae={};["log","info","warn","debug","trace","error"].forEach(function(e){var n=oe[e];"function"==typeof n&&(ae[e]=n.bind(oe,ne))});var ie={};return function(t){var o=this;if(o.console=ae,o.options={shouldEnableOnInit:!1,shouldAlwaysRenewFreeLayoutInfo:!0,cssClassName:{layoutFreeTemporary:"js-stick-on-both-edges-layout-temporarily-free",layoutFree:"js-stick-on-both-edges-layout-free",layoutPinToWindowTop:"js-stick-on-both-edges-layout-hang-to-window-top",layoutPinToParentBottom:"js-stick-on-both-edges-layout-pin-to-lower-boundary"},intervalTimeForRenewingState:500,intervalTimeForUpdatingLayout:40,throttleTimeForScrollAndResizeListeners:16},o.state={shouldEnable:!1,blockHeight:NaN,contentTopToPageTopInFreeLayout:NaN,contentTopToRootTopInFreeLayout:0,contentTopToWindowTopInHangingLayouts:0,contentBottomToLowerBoundaryInHangingLayouts:15,lowerBoundaryRefElement:null,shouldUseBottomEdgeOfLowerBoundaryRefElement:!0,hangingLowerBoundaryToPageTop:NaN},t=t||{},!(t.rootElement instanceof Node))throw new Error("Invalid root element.");if(!(t.hangingBlockElement instanceof Node))throw new Error("Invalid hangingBlock element.");o.elements={root:t.rootElement,hangingBlock:t.hangingBlockElement,lowerBoundaryRef:null};var a={state:{layouts:{isFreeLayout:!0,isPinnedToWindowTop:!1,isPinnerToParentBottom:!1},isEnabled:!1,somethingChanged:!1,hangingLowerBoundaryToWindowTop:NaN,shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout:!1,intervalIDForRenewingState:NaN,intervalIDForUpdatingLayout:NaN},events:{},boundFunctions:{},updatingStatesQueue:[]};o.__pToken=n(ie,e),ie[o.__pToken]=a,o.config=c,o.isEnabled=s,o.currentLayout=u,o.currentLayoutIs=d,o.enableOrDisable=w,o.enable=h,o.disable=y,o.destroy=p,o.renewState=O,o.renewStateAndThenUpdate=S,o.startIntervalOfRenewingState=L,o.clearIntervalOfRenewingState=b,o.startIntervalOfLayoutUpdate=N,o.clearIntervalOfLayoutUpdate=I,o.requestLayoutUpdate=j,o.updateLayout=Y,i(o,t)}}("StickOnBothEdges",n,t,o,window.jQuery&&window.jQuery.throttle||window.Cowboy&&window.Cowboy.throttle);window.module&&window.module.exports?module.exports=a:window.StickOnBothEdges=a}();
//# sourceMappingURL=layout-behaviour-stick-on-both-edges.min.js.map
