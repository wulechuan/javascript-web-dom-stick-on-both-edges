!function(n){function e(n,e){function o(){return e+Date.now()+"-"+(1e6*Math.random()+"").slice(0,6)}e="string"==typeof e?e:"",e=e.replace(/\-+$/,"")+"-";for(var t=o();n[t];)t=o();return t}(function(n,e,o,t){"use strict";function a(n,e){n.config(e),i(n),B.call(n,e,!0),"boolean"==typeof e.shouldEnableHanging?h.call(e.shouldEnableHanging,e.reasonForEnablingOrDisabling||e.reason||"User desired on initialization."):n.options.shouldEnableBahviourAtBeginning&&p.call(n,"Forced to enabled on initialization."),G.call(n);var o=tn[n.__pToken].boundMethods;window.addEventListener("scroll",o.listenToWindowOnScrollEvent)}function i(n){var e=tn[n.__pToken].boundMethods;e.doIntervalForRenewingRelatedInfo=F.bind(null,n),e.doIntervalForUpdateLayout=R.bind(null,n),e.doUpdateLayout=function(){Y(n)}.bind(n);var o=t(n.options.delayTimeInMSForScrollAndResizeLinstenrThrottle,e.doUpdateLayout);e.listenToWindowOnScrollEvent=o,e.listenToWindowOnResizeEvent=o}function r(){return tn[this.__pToken].isEnabled}function l(){var n=tn[this.__pToken];if(n.isInFreeLayout)return"free layout";if(n.isPinnedToWindowTop)return"pinned to top";if(n.isPinnerToParentBottom)return"following lower boundry";throw RangeError(Z,"Fatal: None of the three states are active.")}function s(n){var e=tn[this.__pToken];if(!n||"string"!=typeof n)return!1;switch(n.toLowerCase().replace(/\s*[\s\-]\s*/g,"-").replace(/^\s+/,"").replace(/\s+$/,"")){case"free":case"freelayout":case"default":return e.isInFreeLayout;case"top":case"hanging":case"pinned-to-top":return e.isPinnedToWindowTop;case"following":case"bottom":case"following-lower-boundry":case"pinned-to-bottom":return e.isPinnerToParentBottom}return!1}function u(n){var e,o,t,a=this,i=a.options,r=a.elements;e="hangingLowerBoundryRefEl",o="hangingLowerBoundryRef",n.hasOwnProperty(e)&&(t=n[e],r[o]instanceof Node?t instanceof Node&&(r[o]=t):t instanceof Node?r[o]=t:r[o]=r.parentPositionRef),e="intervalTimeInMSForRenewingRelativInfo",n.hasOwnProperty(e)&&(t=parseInt(n[e]),!isNaN(t)&&t>20&&(i[e]=t)),e="intervalTimeInMSForUpdatingLayout",n.hasOwnProperty(e)&&(t=parseInt(n[e]),!isNaN(t)&&t>20&&(i[e]=t)),d(a,"onEnabling",n),d(a,"onEnabled",n),d(a,"onDisabling",n),d(a,"onDisabled",n),d(a,"onDestroying",n),d(a,"onDestroyed",n),d(a,"onReturningToFreeLayout",n),d(a,"onReturnedToFreeLayout",n),d(a,"onIntervalBegin",n),d(a,"onIntervalEnd",n)}function d(n,e,o){var t=tn[n.__pToken].events,a=o[e];"function"!=typeof a&&void 0!==a||(t[e]=a)}function c(n,e,o,t){var a=tn[n.__pToken].events;return"function"!=typeof a[e]?void(o&&(t=t||'The "'+e+'" is NOT handled.',on.warn(t))):a[e].call(n,n.state)}function g(n){T.call(this,n,!0)}function f(n){var e=n.elements,o=tn[n.__pToken].boundMethods;window.removeEventListener("scroll",o.listenToWindowOnScrollEvent),window.removeEventListener("resize",o.listenToWindowOnResizeEvent),e.root.style.height="",e.chiefContent.style.top="",X(n,null),c(n,"onDestroyed",!0)}function h(n,e,o){if(void 0!==n){n=!!n;if(y(this,n,o)){var t=n?"Enabling":o?"DESTORYING":"DISABLING";return void on.warn(t,"request was cancelled.")}var a={};a.shouldEnableHanging=!!n,a.reason=e&&"string"==typeof e?e:"<unkown>",!n&&o&&(a.isForcedToRenew=!0,a.shouldDestroyAfterDisabled=!0),W.call(this,a),G.call(this)}}function p(n){h.call(this,!0,n)}function T(n,e){h.call(this,!1,n,e)}function y(n,e,o){if(e)return c(n,"onEnabling");var t=c(n,"onDisabling");if(t){if(!o)return t;on.warn("Destroying request will be cancelled by onDisabling handler.")}return c(n,"onDestroying")}function w(n,e){var o=n.state;tn[n.__pToken].isEnabled=e,e?(delete o.shouldDestroyAfterDisabled,c(n,"onEnabled")):(c(n,"onDisabled"),n.clearIntervalForRenewingRelatedInfo(),n.clearIntervalForUpdateLayout(),o.shouldDestroyAfterDisabled&&f(n))}function v(){I(this,!0)}function L(){I(this,!1)}function I(n,e){var o=tn[n.__pToken],t=e?"Starting":"STOPPING",a="interval for renewing related info.",i="intervalIDForRenewingRelatedInfo",r=o[i],l=!isNaN(r);e&&!l?(on.info(t,a),o[i]=setInterval(o.boundMethods.doIntervalForRenewingRelatedInfo,n.options.intervalTimeInMSForRenewingRelativInfo)):!e&&l&&(on.warn(t,a),clearInterval(r),o[i]=NaN)}function F(n){c(n,"onIntervalBegin")||(_.call(n,!0),D.call(n,!0),C.call(n,!0),H.call(n,!0)),c(n,"onIntervalEnd")}function m(){N(this,!0)}function b(){N(this,!1)}function N(n,e){var o=tn[n.__pToken],t=e?"Starting":"STOPPING",a="intervalIDForUpdatingLayout",i=o[a],r=!isNaN(i);e&&!r?(on.info(t,"interval for updating layout."),o[a]=setInterval(o.boundMethods.doIntervalForUpdateLayout,n.options.intervalTimeInMSForUpdatingLayout)):!e&&r&&(on.warn(t,"interval for updating layout."),clearInterval(i),o[a]=NaN)}function R(n){G.call(n)}function E(n){B.call(this,n,!1),G.call(this)}function B(n,e){var o=!0;"object"==typeof n&&n&&(P.call(this,n.contentTopToWindowTopInHangingLayouts,e),k.call(this,n.contentBottomDistanceToLowerBoundryInHangingLayouts,e),o=S.call(this,n.shouldUseBottomOfHangingLowerBoundryRef,e)),o&&D.call(this,e),_.call(this,e),C.call(this,e),H.call(this,e)}function _(n){var e={blockHeight:this.elements.chiefContent.offsetHeight};n&&(e.isForcedToUpdate=!0),W.call(this,e)}function C(n){var e={};n&&(e.isForcedToUpdate=!0),e.contentTopToRootTopInFreeLayout=this.elements.chiefContent.offsetTop,W.call(this,e)}function P(n,e){var o={};e&&(o.isForcedToUpdate=!0),n=parseFloat(n),isNaN(n)||(o.contentTopToWindowTopInHangingLayouts=n),W.call(this,o)}function k(n,e){var o={};e&&(o.isForcedToUpdate=!0),n=parseFloat(n),isNaN(n)||(o.contentBottomDistanceToLowerBoundryInHangingLayouts=n),W.call(this,o)}function H(n){var e,o=this,t=tn[o.__pToken],a=!0,i=!0;t.isInFreeLayout||(n?(t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1,e=o.state.methodForSwitchingToCurrentLayout,i=Q(o,n,!0)):(a=!1,t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!0)),a&&U(o,n),i||"function"!=typeof e||e(o)}function U(n,e){var o=n.elements.chiefContent.getBoundingClientRect();if(0===o.width&&0===o.height)return void on.warn('\n\t Cannot evaluate chiefContentEl\'s "boundingClientRect"!',"\n\t The chief content elment might not be visible at the moment.");var t={};e&&(t.isForcedToUpdate=!0),t.contentTopToPageTopInFreeLayout=o.top+window.scrollY,W.call(n,t)}function S(n,e){var o=this,t=o.elements;if(t.parentPositionRef===t.hangingLowerBoundryRef||null===n||void 0===n)return!0;o.state.shouldUseBottomOfHangingLowerBoundryRef=!!n;var a={};return e&&(a.isForcedToUpdate=!0),D.call(this,e),!1}function D(n){var e=O(this);n&&(e.isForcedToUpdate=!0),W.call(this,e)}function O(n){var e=n.state,o="hangingLowerBoundryToPageTop",t=NaN,a=NaN,i=n.elements.hangingLowerBoundryRef.getBoundingClientRect();0===i.width&&0===i.height?on.warn("Reference element for deciding hanging lower boundry is invisible at this moment."):(t=i[e.shouldUseBottomOfHangingLowerBoundryRef?"bottom":"top"],a=t+window.scrollY),tn[n.__pToken].hangingLowerBoundryToWindowTop=t,e[o]=a;var r={};return r[o]=a,r}function W(n){var e=this,t=tn[e.__pToken].queuedStatesForUpdatesOfLayout;!t[t.length-1]&&t.push({});var a=t[t.length-1];"function"==typeof n?n.call(e,a):"object"!=typeof n||Array.isArray(n)?a.isForcedToUpdate=a.isForcedToUpdate||void 0===n||!!n:o(a,n)}function A(n){var e=tn[n.__pToken],o=e.queuedStatesForUpdatesOfLayout.shift();return x(n,n.state,o),o}function M(n,e){o(n.state,e)}function x(n,e,o){j(n,e,o),z(n,o)}function j(n,e,o){Object.keys(n.state).forEach(function(t){q(t,e,o)?tn[n.__pToken].somethingChanged=!0:delete o[t]})}function q(n,e,o){var t=!1,a=e[n],i=o[n];return void 0!==i&&null!==i&&(void 0===a||null===a?t=!0:a!==i&&(t=!(isNaN(a)&&isNaN(i))),t)}function z(n,e){if(tn[n.__pToken].somethingChanged){var o,t,a,i;if("boolean"==typeof e.shouldEnableHanging){o="reason";var r=e.shouldEnableHanging;t=r?"Enabling":e.shouldDestroyAfterDisabled?"DESTORYING":"DISABLING",a="behaviour...\n",i=e[o],i=nn.slice("Reason: ".length)+"Reason: "+i.replace(/\n/g,"\n "+nn),r?on.info(t,a,i):on.warn(t,a," ",i)}}}function G(){var n=this,e=tn[n.__pToken],o=n.state;if(!(e.queuedStatesForUpdatesOfLayout.length<1)){var t=A(n),a=t.isForcedToUpdate;delete t.isForcedToUpdate,(e.somethingChanged||a)&&(M(n,t),Y(n,a)),"boolean"==typeof t.shouldEnableHanging&&(w(n,t.shouldEnableHanging),delete o.reason)}}function Y(n,e){var o=n.elements,t=tn[n.__pToken],a=n.state;O(n);var i=a.contentTopToWindowTopInHangingLayouts,r=window.scrollY+i,l=a.hangingLowerBoundryToPageTop-a.contentTopToPageTopInFreeLayout,s=a.blockHeight+a.contentBottomDistanceToLowerBoundryInHangingLayouts,u=t.hangingLowerBoundryToWindowTop-i,d=a.blockHeight,c=window.innerHeight<s||!isNaN(l)&&l<s;!a.shouldEnableHanging||c||r<=a.contentTopToPageTopInFreeLayout?Q(n,e):u<=s?V(n,e,d,l-s+o.root.clientTop+a.contentTopToRootTopInFreeLayout):$(n,e,d,a.contentTopToWindowTopInHangingLayouts),t.somethingChanged=!1,delete a.methodForSwitchingToCurrentLayout}function Q(n,e,o){var t=tn[n.__pToken],a=t.isInFreeLayout,i=J(n,{methodForSwitchingToCurrentLayout:Q,isForcedToUpdate:e,pNameOfLayoutMark:"isInFreeLayout",pNameOfCssClass:o?"layoutFreeTemporary":"layoutFree",rootElHeight:"",contentElTop:""});if(!i){var r=n.options.shouldAlwaysRenewFreeLayoutInfo;!r&&!t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout||a||E.call(n),t.shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout=!1}return i}function $(n,e,o,t){return J(n,{methodForSwitchingToCurrentLayout:$,isForcedToUpdate:e,pNameOfLayoutMark:"isPinnedToWindowTop",pNameOfCssClass:"layoutPinToWindowTop",rootElHeight:o+"px",contentElTop:t+"px"})}function V(n,e,o,t){return J(n,{methodForSwitchingToCurrentLayout:V,isForcedToUpdate:e,pNameOfLayoutMark:"isPinnerToParentBottom",pNameOfCssClass:"layoutPinToParentBottom",rootElHeight:o+"px",contentElTop:t+"px"})}function J(n,e){var o=tn[n.__pToken],t=n.state,a=n.elements,i=e.pNameOfLayoutMark,r=e.logStringWhenActuallySwitching;return!(!o[i]||o.somethingChanged||e.isForcedToUpdate)||(e.shouldDebug&&r&&on.info(r),t.methodForSwitchingToCurrentLayout=e.methodForSwitchingToCurrentLayout,K(n,i),X(n,e.pNameOfCssClass),a.chiefContent.style.top=e.contentElTop,a.root.style.height=e.rootElHeight,!1)}function K(n,e){var o=tn[n.__pToken];["isInFreeLayout","isPinnedToWindowTop","isPinnerToParentBottom"].forEach(function(n){o[n]=e===n})}function X(n,e){var o=n.elements.chiefContent.classList,t=n.options.cssClassName;for(var a in t){var i=t[a];a===e?i&&o.add(i):i&&o.remove(i)}}var Z="{"+n+"} ==>",nn=Z.replace(/\S/g," "),en=window.console,on={};["log","info","warn","debug","trace","error"].forEach(function(n){var e=en[n];"function"==typeof e&&(on[n]=e.bind(en,Z))});var tn={};return function(o){var t=this;if(t.console=on,t.options={shouldEnableBahviourAtBeginning:!1,shouldAlwaysRenewFreeLayoutInfo:!0,cssClassName:{layoutFreeTemporary:"js-stick-on-both-edges-layout-temporary-state",layoutFree:"js-stick-on-both-edges-layout-free",layoutPinToWindowTop:"js-stick-on-both-edges-layout-hang-to-window-top",layoutPinToParentBottom:"js-stick-on-both-edges-layout-pin-to-lower-boundry"},intervalTimeInMSForRenewingRelativInfo:500,intervalTimeInMSForUpdatingLayout:40,delayTimeInMSForScrollAndResizeLinstenrThrottle:16},t.state={shouldEnableHanging:!1,blockHeight:NaN,contentTopToPageTopInFreeLayout:NaN,contentTopToRootTopInFreeLayout:0,contentTopToWindowTopInHangingLayouts:0,contentBottomDistanceToLowerBoundryInHangingLayouts:15,shouldUseBottomOfHangingLowerBoundryRef:!1,hangingLowerBoundryToPageTop:NaN},o=o||{},!(o.parentPositionRefEl instanceof Node))throw new Error("Invalid parentPositionRef element.");if(!(o.rootEl instanceof Node))throw new Error("Invalid root element.");if(!(o.chiefContentEl instanceof Node))throw new Error("Invalid chiefContent element.");t.elements={root:o.rootEl,chiefContent:o.chiefContentEl,parentPositionRef:o.parentPositionRefEl,hangingLowerBoundryRef:null};var i={isEnabled:!1,isInFreeLayout:!0,isPinnedToWindowTop:!1,isPinnerToParentBottom:!1,events:{},boundMethods:{},queuedStatesForUpdatesOfLayout:[],somethingChanged:!1,hangingLowerBoundryToWindowTop:NaN,shouldRenewFreeLayoutInfoNextTimeEnteringFreeLayout:!1,intervalIDForRenewingRelatedInfo:NaN,intervalIDForUpdatingLayout:NaN};t.__pToken=e(tn,n),tn[t.__pToken]=i,t.config=u,t.isEnabled=r,t.currentLayout=l,t.currentLayoutIs=s,t.enableOrDisableHangingBehaviour=h,t.enableHangingBehaviour=p,t.disableHangingBehaviour=T,t.destroy=g,t.renewAllRelatedInfoAndThenUpdate=E,t.renewAllRelatedInfo=B,t.renewContentTopToPageTopInFreeLayout=H,t.renewContentHeight=_,t.renewContentTopToRootTopInFreeLayout=C,t.renewContentTopToWindowTopInHangingLayouts=P,t.renewHangingLowerBoundryValue=D,t.renewHangingLowerBoundryUsedBorder=S,t.startIntervalForRenewingRelatedInfo=v,t.clearIntervalForRenewingRelatedInfo=L,t.startIntervalForUpdateLayout=m,t.clearIntervalForUpdateLayout=b,t.requestAnUpdateOfLayout=W,t.updateLayout=G,a(t,o)}})("StickOnBothEdges",e,window.jQuery.extend,window.jQuery.throttle)}();